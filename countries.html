<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VWX5EMQSLM"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-VWX5EMQSLM');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ship CO2 emissions ranked by flag state. See which countries' registered vessels pollute the most, including flags of convenience like Liberia, Panama, and Marshall Islands.">
    <meta name="keywords" content="ship emissions by country, flag state emissions, Liberia ships CO2, Panama flag pollution, Marshall Islands vessels, maritime emissions by country, flag of convenience pollution">
    <meta name="author" content="Dirtiest Ships">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://dirtiestships.com/countries.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://dirtiestships.com/countries.html">
    <meta property="og:title" content="CO2 Emissions by Country - Dirtiest Ships">
    <meta property="og:description" content="Ship CO2 emissions ranked by flag state. See which countries' registered vessels pollute the most.">
    <meta property="og:site_name" content="Dirtiest Ships">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://dirtiestships.com/countries.html">
    <meta name="twitter:title" content="CO2 Emissions by Country - Dirtiest Ships">
    <meta name="twitter:description" content="Ship CO2 emissions ranked by flag state. See which countries' registered vessels pollute the most.">

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9641573711172527"
     crossorigin="anonymous"></script>
    <title>CO2 Emissions by Country - Dirtiest Ships</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            background: rgba(0,0,0,0.3);
            margin-bottom: 30px;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }

        .header-img {
            position: absolute;
            top: 0;
            height: 100%;
            width: 200px;
            object-fit: cover;
            filter: grayscale(100%) opacity(0.4);
            pointer-events: none;
        }

        .header-img-left {
            left: 0;
            mask-image: linear-gradient(to right, rgba(0,0,0,1) 0%, rgba(0,0,0,0) 100%);
            -webkit-mask-image: linear-gradient(to right, rgba(0,0,0,1) 0%, rgba(0,0,0,0) 100%);
        }

        .header-img-right {
            right: 0;
            mask-image: linear-gradient(to left, rgba(0,0,0,1) 0%, rgba(0,0,0,0) 100%);
            -webkit-mask-image: linear-gradient(to left, rgba(0,0,0,1) 0%, rgba(0,0,0,0) 100%);
        }

        h1 {
            font-size: 2.5rem;
            color: #ff6b6b;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #888;
        }

        .year-selector select {
            padding: 10px 20px;
            font-size: 1rem;
            border: 1px solid #4ecdc4;
            border-radius: 25px;
            background: rgba(0,0,0,0.3);
            color: #4ecdc4;
            cursor: pointer;
            font-weight: bold;
        }

        .year-selector select option {
            background: #1a1a2e;
        }

        nav {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        nav a {
            color: #4ecdc4;
            text-decoration: none;
            padding: 10px 20px;
            border: 1px solid #4ecdc4;
            border-radius: 25px;
            transition: all 0.3s;
        }

        nav a:hover, nav a.active {
            background: #4ecdc4;
            color: #1a1a2e;
        }

        .chart-container {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .chart-wrapper {
            position: relative;
            height: 600px;
        }

        .note {
            margin-top: 20px;
            padding: 15px;
            background: rgba(78, 205, 196, 0.1);
            border-left: 3px solid #4ecdc4;
            border-radius: 5px;
            font-size: 0.9rem;
            color: #aaa;
        }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2rem;
            color: #888;
        }

        footer {
            text-align: center;
            padding: 30px;
            color: #666;
            font-size: 0.9rem;
        }

        footer a {
            color: #4ecdc4;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }

            .chart-wrapper {
                height: 500px;
            }

            .chart-container {
                padding: 15px;
            }

            nav {
                gap: 10px;
            }

            nav a {
                padding: 8px 15px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <img src="images/ship-smoke-left.jpg" alt="" class="header-img header-img-left">
            <img src="images/ship-smoke-right.jpg" alt="" class="header-img header-img-right">
            <h1>Dirtiest Ships <span style="font-size: 0.5em; font-weight: normal;">(in Europe)</span></h1>
            <p class="subtitle" id="subtitle">Top 20 Countries by CO2-eq Emissions (2024)</p>
            <nav>
                <div class="year-selector">
                    <select id="year-select">
                        <option value="2024">2024</option>
                        <option value="2023">2023</option>
                        <option value="2022">2022</option>
                        <option value="2021">2021</option>
                        <option value="2020">2020</option>
                    </select>
                </div>
                <a href="index.html">Ship Rankings</a>
                <a href="chart.html">By Ship Type</a>
                <a href="companies.html">By Company</a>
                <a href="countries.html" class="active">By Country</a>
                <a href="compare.html">Peer Compare</a>
            </nav>
        </header>

        <div class="chart-container">
            <div class="chart-wrapper">
                <canvas id="chart"></canvas>
            </div>
            <div class="note">
                <strong>Note:</strong> Country refers to the flag state (port of registry), not the ship's operating region or company nationality.
                Major flag states like Liberia, Marshall Islands, and Panama are popular "flags of convenience" used by international shipping companies.
            </div>
        </div>

        <footer>
            <p>Data source: <a href="https://mrv.emsa.europa.eu/" target="_blank">EU MRV Regulation</a></p>
            <p>This data shows annual CO2 emissions from ships calling at EU/EEA ports.</p>
        </footer>
    </div>

    <script>
        let chart = null;

        function loadData(year) {
            const isNew = year === '2024';
            const co2Field = isNew ? 'co2eq' : 'co2';
            const co2Label = isNew ? 'CO2-eq' : 'CO2';

            document.getElementById('subtitle').textContent = `Top 20 Countries by ${co2Label} Emissions (${year})`;

            fetch(`json/${year}_countries_top20.json`)
                .then(response => response.json())
                .then(data => {
                    const ctx = document.getElementById('chart').getContext('2d');

                    if (chart) {
                        chart.destroy();
                    }

                    const colors = [
                        '#ff6b6b', '#4ecdc4', '#ffe66d', '#95e1d3', '#f38181',
                        '#aa96da', '#fcbad3', '#a8d8ea', '#ff9a3c', '#1fab89',
                        '#62d2a2', '#9df3c4', '#d7fbe8', '#f9ed69', '#f08a5d',
                        '#b83b5e', '#6a2c70', '#c9b1ff', '#5c969e', '#ffc75f'
                    ];

                    chart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: data.map(d => d.country),
                            datasets: [{
                                label: `${co2Label} Emissions (million tonnes)`,
                                data: data.map(d => (d[co2Field] || d.co2) / 1000000),
                                backgroundColor: colors,
                                borderColor: colors,
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const item = data[context.dataIndex];
                                            const emissions = item[co2Field] || item.co2;
                                            return [
                                                `${co2Label}: ${(emissions / 1000000).toFixed(2)} million tonnes`,
                                                `Ships: ${item.count.toLocaleString()}`
                                            ];
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    ticks: {
                                        color: '#888',
                                        maxRotation: 45,
                                        minRotation: 45
                                    },
                                    grid: {
                                        color: 'rgba(255,255,255,0.1)'
                                    }
                                },
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        color: '#888',
                                        callback: function(value) {
                                            return value + ' M';
                                        }
                                    },
                                    grid: {
                                        color: 'rgba(255,255,255,0.1)'
                                    },
                                    title: {
                                        display: true,
                                        text: `${co2Label} (million tonnes)`,
                                        color: '#888'
                                    }
                                }
                            }
                        }
                    });
                })
                .catch(error => {
                    document.querySelector('.chart-wrapper').innerHTML =
                        '<p class="loading">Error loading data.</p>';
                });
        }

        document.getElementById('year-select').addEventListener('change', (e) => {
            loadData(e.target.value);
        });

        loadData('2024');
    </script>
</body>
</html>
