<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VWX5EMQSLM"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-VWX5EMQSLM');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Overview of shipping companies ranked by total reported COâ‚‚ emissions from vessels operating in European waters.">
    <meta name="keywords" content="shipping company emissions, MSC CO2, Maersk emissions, CMA CGM pollution, maritime company ranking, shipping corporation CO2, top polluting shipping companies">
    <meta name="author" content="Dirtiest Ships">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://dirtiestships.com/companies.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://dirtiestships.com/companies.html">
    <meta property="og:title" content="Shipping Companies Ranked by COâ‚‚ Emissions">
    <meta property="og:description" content="Overview of shipping companies ranked by total reported COâ‚‚ emissions from vessels operating in European waters.">
    <meta property="og:site_name" content="Dirtiest Ships">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://dirtiestships.com/companies.html">
    <meta name="twitter:title" content="Shipping Companies Ranked by COâ‚‚ Emissions">
    <meta name="twitter:description" content="Overview of shipping companies ranked by total reported COâ‚‚ emissions from vessels operating in European waters.">

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9641573711172527"
     crossorigin="anonymous"></script>
    <title>Shipping Companies Ranked by COâ‚‚ Emissions | DirtiestShips</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <img src="images/ship-smoke-left.jpg" alt="" class="header-img header-img-left">
            <img src="images/ship-smoke-right.jpg" alt="" class="header-img header-img-right">
            <h1>Dirtiest Ships <span style="font-size: 0.5em; font-weight: normal;">(in Europe)</span></h1>
            <p class="subtitle" id="subtitle">Top 15 Companies by CO2-eq Emissions (2024)</p>
            <nav>
                <div class="year-selector">
                    <select id="year-select">
                        <option value="2024">2024</option>
                        <option value="2023">2023</option>
                        <option value="2022">2022</option>
                    </select>
                </div>
                <a href="index.html">Ship Rankings</a>
                <a href="chart.html">By Ship Type</a>
                <a href="companies.html" class="active">By Company</a>
                <a href="countries.html">By Country</a>
                <a href="compare.html">Peer Compare</a>
                <a href="cii.html">CII Ratings</a>
                <a href="rules.html">Regulations</a>
                <a href="news.html">News</a>
                <a href="blog.html">Blog</a>
                <a href="FAQ.html">Why?</a>
            </nav>
        </header>

        <div class="chart-container">
            <div class="chart-wrapper">
                <canvas id="chart"></canvas>
            </div>
            <div class="note" id="note">
                <strong>Note:</strong> Companies are consolidated where the same parent company reports under multiple subsidiaries.
                For example, MSC Group includes MSC Shipmanagement Ltd, Mediterranean Shipping Co, and MSC Cruises.
                CMA CGM Group includes CMA Ships and various regional CMA CGM entities.
                Carnival Corporation includes Costa Crociere and Holland America Line.
            </div>
        </div>

        <div class="chart-container" id="company-list-container" style="display: none;">
            <h3 style="color: #4ecdc4; margin-bottom: 20px;">All Companies by CO2-eq Emissions</h3>
            <div class="controls">
                <div class="search-box">
                    <input type="text" id="company-search" placeholder="Search companies...">
                </div>
            </div>
            <div class="table-container">
                <table id="company-table">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Company</th>
                            <th>CO2-eq (tonnes)</th>
                            <th>Ships</th>
                        </tr>
                    </thead>
                    <tbody id="company-tbody">
                    </tbody>
                </table>
            </div>
            <div class="pagination" id="pagination"></div>
        </div>

        <footer>
            <div class="footer-links">
                <a href="FAQ.html">FAQ</a>
                <a href="disclaimer.html">Disclaimer</a>
                <a href="privacy.html">Privacy Policy</a>
                <a href="mailto:hello@dirtiestships.com">hello@dirtiestships.com</a>
            </div>
            <p>Data source: <a href="https://mrv.emsa.europa.eu/" target="_blank">EU MRV Regulation</a></p>
            <p>This data shows annual CO2 emissions from ships calling at EU/EEA ports.</p>
        </footer>
    </div>

    <script>
        let chart = null;
        let allCompanies = [];
        let filteredCompanies = [];
        const ROWS_PER_PAGE = 50;
        let currentPage = 1;

        function loadData(year) {
            const isNew = year === '2024';
            const co2Label = isNew ? 'CO2-eq' : 'CO2';

            document.getElementById('subtitle').textContent = `Top 15 Companies by ${co2Label} Emissions (${year})`;

            // Only 2024 has company data
            if (year !== '2024') {
                if (chart) {
                    chart.destroy();
                    chart = null;
                }
                document.querySelector('.chart-wrapper').innerHTML =
                    '<p class="loading">Company data is only available for 2024.<br>The 2022 and 2023 datasets do not include company information.</p>';
                document.getElementById('note').style.display = 'none';
                document.getElementById('company-list-container').style.display = 'none';
                return;
            }

            document.getElementById('note').style.display = 'block';
            document.getElementById('company-list-container').style.display = 'block';
            document.querySelector('.chart-wrapper').innerHTML = '<canvas id="chart"></canvas>';

            fetch(`json/${year}_companies_top15.json`)
                .then(response => response.json())
                .then(data => {
                    const ctx = document.getElementById('chart').getContext('2d');

                    if (chart) {
                        chart.destroy();
                    }

                    const colors = [
                        '#ff6b6b', '#4ecdc4', '#ffe66d', '#95e1d3', '#f38181',
                        '#aa96da', '#fcbad3', '#a8d8ea', '#ff9a3c', '#1fab89',
                        '#62d2a2', '#9df3c4', '#d7fbe8', '#f9ed69', '#f08a5d'
                    ];

                    chart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: data.map(d => d.company),
                            datasets: [{
                                label: `${co2Label} Emissions (million tonnes)`,
                                data: data.map(d => d.co2eq / 1000000),
                                backgroundColor: colors,
                                borderColor: colors,
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const item = data[context.dataIndex];
                                            return [
                                                `${co2Label}: ${(item.co2eq / 1000000).toFixed(2)} million tonnes`,
                                                `Ships: ${item.count.toLocaleString()}`
                                            ];
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    ticks: {
                                        color: '#888',
                                        maxRotation: 45,
                                        minRotation: 45
                                    },
                                    grid: {
                                        color: 'rgba(255,255,255,0.1)'
                                    }
                                },
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        color: '#888',
                                        callback: function(value) {
                                            return value + ' M';
                                        }
                                    },
                                    grid: {
                                        color: 'rgba(255,255,255,0.1)'
                                    },
                                    title: {
                                        display: true,
                                        text: `${co2Label} (million tonnes)`,
                                        color: '#888'
                                    }
                                }
                            }
                        }
                    });
                })
                .catch(error => {
                    document.querySelector('.chart-wrapper').innerHTML =
                        '<p class="loading">Error loading data.</p>';
                });

            // Load full company list
            loadCompanyList();
        }

        function loadCompanyList() {
            fetch('json/2024_companies_all.json')
                .then(response => response.json())
                .then(data => {
                    allCompanies = data;
                    filteredCompanies = data;
                    currentPage = 1;
                    renderCompanyTable();
                })
                .catch(error => {
                    document.getElementById('company-tbody').innerHTML =
                        '<tr><td colspan="4">Error loading company data.</td></tr>';
                });
        }

        // European countries with annual CO2 emissions (2023 EEA data, in tonnes)
        const europeanCountryEmissions = [
            { name: 'Malta', flag: 'ðŸ‡²ðŸ‡¹', co2: 2100000, isCountry: true },
            { name: 'Iceland', flag: 'ðŸ‡®ðŸ‡¸', co2: 3500000, isCountry: true },
            { name: 'Cyprus', flag: 'ðŸ‡¨ðŸ‡¾', co2: 7200000, isCountry: true },
            { name: 'Luxembourg', flag: 'ðŸ‡±ðŸ‡º', co2: 8100000, isCountry: true },
            { name: 'Latvia', flag: 'ðŸ‡±ðŸ‡»', co2: 8400000, isCountry: true },
            { name: 'Estonia', flag: 'ðŸ‡ªðŸ‡ª', co2: 10500000, isCountry: true },
            { name: 'Slovenia', flag: 'ðŸ‡¸ðŸ‡®', co2: 13200000, isCountry: true },
            { name: 'Lithuania', flag: 'ðŸ‡±ðŸ‡¹', co2: 14100000, isCountry: true },
            { name: 'Croatia', flag: 'ðŸ‡­ðŸ‡·', co2: 17500000, isCountry: true },
            { name: 'Ireland', flag: 'ðŸ‡®ðŸ‡ª', co2: 37800000, isCountry: true },
        ];

        // Get emission severity class based on rank
        function getEmissionSeverity(rank) {
            if (rank <= 15) return 'emission-extreme';
            if (rank <= 50) return 'emission-high';
            if (rank <= 200) return 'emission-medium';
            if (rank <= 500) return 'emission-low';
            return 'emission-minimal';
        }

        function renderCompanyTable() {
            const tbody = document.getElementById('company-tbody');
            const start = (currentPage - 1) * ROWS_PER_PAGE;
            const end = start + ROWS_PER_PAGE;

            // Merge companies with countries for display
            // Add rank to companies and convert for unified list
            const companiesWithRank = filteredCompanies.map((c, i) => ({
                ...c,
                rank: i + 1,
                co2: c.co2eq,
                isCountry: false
            }));

            // Only include countries with emissions smaller than the top company
            const topCompanyEmissions = filteredCompanies.length > 0 ? filteredCompanies[0].co2eq : 0;
            const countriesSmaller = europeanCountryEmissions.filter(c => c.co2 < topCompanyEmissions);

            // Merge and sort by emissions (descending)
            const merged = [...companiesWithRank, ...countriesSmaller]
                .sort((a, b) => b.co2 - a.co2);

            // Find which items fall in current page range
            // We need to track company ranks separately
            const pageData = merged.slice(start, end);

            tbody.innerHTML = pageData.map((item, index) => {
                const animDelay = `style="animation-delay: ${index * 0.02}s"`;

                if (item.isCountry) {
                    // Country row - no rank, different styling
                    return `
                        <tr class="country-row" ${animDelay}>
                            <td class="rank"></td>
                            <td>${item.flag} ${escapeHtml(item.name)} <span class="country-label">country</span></td>
                            <td class="co2-value">${item.co2.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0})}</td>
                            <td>-</td>
                        </tr>
                    `;
                } else {
                    // Company row
                    const severityClass = getEmissionSeverity(item.rank);
                    return `
                        <tr class="${severityClass}" ${animDelay}>
                            <td class="rank">${item.rank}</td>
                            <td>${escapeHtml(item.company)}</td>
                            <td class="co2-value">${item.co2.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                            <td>${item.count}</td>
                        </tr>
                    `;
                }
            }).join('');

            renderPagination(merged.length, countriesSmaller.length);
        }

        function renderPagination(totalItems, countryCount) {
            const total = totalItems || filteredCompanies.length;
            const countries = countryCount || 0;
            const totalPages = Math.ceil(total / ROWS_PER_PAGE);
            const pagination = document.getElementById('pagination');

            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }

            const countryText = countries > 0 ? ` + ${countries} countries` : '';
            pagination.innerHTML = `
                <button onclick="goToPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>Previous</button>
                <span class="page-info">Page ${currentPage} of ${totalPages} (${filteredCompanies.length} companies${countryText})</span>
                <button onclick="goToPage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>Next</button>
            `;
        }

        function goToPage(page) {
            const topCompanyEmissions = filteredCompanies.length > 0 ? filteredCompanies[0].co2eq : 0;
            const countriesCount = europeanCountryEmissions.filter(c => c.co2 < topCompanyEmissions).length;
            const totalPages = Math.ceil((filteredCompanies.length + countriesCount) / ROWS_PER_PAGE);
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                renderCompanyTable();
            }
        }

        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Search functionality
        document.getElementById('company-search').addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            if (query === '') {
                filteredCompanies = allCompanies;
            } else {
                filteredCompanies = allCompanies.filter(c =>
                    c.company.toLowerCase().includes(query)
                );
            }
            currentPage = 1;
            renderCompanyTable();
        });

        document.getElementById('year-select').addEventListener('change', (e) => {
            loadData(e.target.value);
        });

        loadData('2024');
    </script>
</body>
</html>
